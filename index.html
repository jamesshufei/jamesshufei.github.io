<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>114年資通安全實地稽核檢查表</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        .header {
            display: flex;
            align-items: center;
            background-image: url('bg.png');
            background-size: cover;
            background-position: center;
            padding: 10px;
            border-bottom: 2px solid #ccc;
            position: relative;
        }
        .header .logo {
            width: 70px;
            height: 70px;
            cursor: pointer;
            margin-right: 10px;
        }
        .header .regulations-btn {
            height: 25px;
            font-size: 14px;
            padding: 2px 5px;
            background-color: #00004d;
            color: yellow; /* 改為黃色 */
            border: none;
            border-radius: 5px;
            cursor: pointer;
            width: 110px;
            margin-top: 5px;
            box-sizing: border-box;
        }
        .header .regulations-btn:hover {
            background-color: #0056b3;
        }
        
        .header .title-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex-grow: 1;
        }
        .header .title {
            font-size: 24px;
            font-weight: bold;
            margin: 5px 0;
        }
        .header .subtitle {
            font-size: 18px;
            color: black;
        }

        .header-buttons {
        display: flex;
        gap: 10px;
        position: absolute;
        left: 230px;
        top: 58px; /* 直接調整到與資安法規按鈕相同的高度 */
        }

        .header-btn {
        height: 25px;
        font-size: 14px;
        padding: 2px 5px;
        background-color: #00004d;
        color: #00ff00; /* 改為綠色 */
        border: none;
        border-radius: 5px;
        cursor: pointer;
        width: 110px;
        box-sizing: border-box;
        }

        .header-btn:hover {
            background-color: #0056b3;
        }
        .dropdown-container {
            display: flex;
            align-items: center;
            gap: 5px;
            position: absolute;
            right: 150px;
            bottom: 5px;
        }
        .dropdown-container select {
            padding: 5px;
            font-size: 14px;
            text-align: center; /* 在這裡新增文字置中 */
        }
        .dropdown-container button {
            padding: 5px 10px;
            background-color: #00004d;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }
        .dropdown-container button:hover {
            background-color: #0056b3;
        }
        .color-input {
            display: flex;
            align-items: center;
            gap: 10px;
            position: absolute;
            right: 20px;
            bottom: 5px;
        }
        .color-input input[type="color"] {
            width: 30px;
            height: 30px;
            border: none;
            cursor: pointer;
        }
        .color-button {
            padding: 5px 10px;
            background-color: #00004d;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }
        .color-button:hover {
            background-color: #0056b3;
        }
        .main {
            display: flex;
            flex: 1;
            height: 100%;
            overflow: hidden;
        }
        .left-frame {
            flex: 0 0 auto;
            width: clamp(200px, 15vw, 400px); /* 使用 clamp 設置最小、預設和最大寬度 */
            background-image: url('bg-left.png');
            background-repeat: no-repeat;
            background-position: center;
            border-right: 2px solid #ccc;
            padding: 10px;
            overflow-y: auto;
            resize: horizontal;
            position: relative;
            box-sizing: border-box;
            min-width: 180px; /* 最小寬度 */
            max-width: 50vw; /* 最大寬度為視窗寬度的 50% */
        }

        .middle-frame {
            flex: 1 1 45%; /* 可縮放，基準值 45% */
            background-color: #52527a;
            border-right: 2px solid #ccc;
            display: flex;
            justify-content: center;
            align-items: center;
            min-width: 200px; /* 設置最小寬度 */
        }

        .right-frame {
            flex: 1 1 45%; /* 可縮放，基準值 45% */
            background-color: #52527a;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            color: white;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            min-width: 200px; /* 設置最小寬度 */
        }

        .right-frame img {
            max-width: 100%;
            max-height: 100%;
        }
        /* 按鈕容器樣式 */
        .button {
            display: block;
            margin: 5px 0;
            padding: 10px;
            background-color: #00004d;
            color: white;
            text-align: left;
            border: 1px solid #ccc;
            border-radius: 5px;
            cursor: pointer;
            font-size: clamp(11px, 1vw, 14px); /* 自適應字體大小 */
            width: 100%;
            box-sizing: border-box;
            transition: color 0.3s ease, background-color 0.3s ease;
            word-wrap: break-word; /* 允許文字換行 */
        }
        .button:hover {
            background-color: #0056b3;
        }
        .middle-frame img, .right-frame img {
            max-width: 100%;
            max-height: 100%;
        }
        .digital-clock {
            background-color: #00004d;
            color: #00ffff;
            padding: 3px 5px;
            border-radius: 5px;
            font-family: monospace;
            text-align: center;
            width: 110px;
            display: flex;
            flex-direction: column;
            gap: 0px;
            box-sizing: border-box;
        }
        .clock-container {
            position: absolute;
            left: 110px;
            top: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 1;
        }
        .time-text {
            font-size: 16px;
            line-height: 1.2;
        }
        .date-text {
            font-size: 13px;
            line-height: 1.2;
        }

        /* sub-buttons 容器樣式 */
        .sub-buttons {
            display: flex;
            gap: 5px;
            margin: 5px 0;
            width: 100%;
            box-sizing: border-box;
        }

        .sub-button,
        .sub2-button {
            flex: 1;
            padding: 10px;
            background-color: #00004d;
            border: 2px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
            font-size: clamp(11px, 1vw, 14px); /* 自適應字體大小 */
            text-align: left;
            box-sizing: border-box;
            transition: color 0.3s ease, background-color 0.3s ease;
            word-wrap: break-word; /* 允許文字換行 */
            min-width: 0; /* 允許按鈕縮小到比內容更小 */
            display: flex; /* 新增 */
            justify-content: center; /* 新增：水平置中 */
            align-items: center; /* 新增：垂直置中 */
        }

        .sub-button:hover {
            background-color: #0056b3;
        }

        
        .sub2-button:hover {
            background-color: #0056b3;
        }
         
            /* 特定顏色設置 */
        .sub-button {
            color: rgb(38, 222, 255);
        }

        .sub2-button {
            color: rgb(248, 184, 253);
        }

        /* 響應式媒體查詢 */
        @media screen and (max-width: 768px) {
            .left-frame {
                width: clamp(150px, 25vw, 300px);
            }
            
            .button,
            .sub-button,
            .sub2-button {
                padding: 8px;
                font-size: 11px;
            }
        }

        @media screen and (max-width: 480px) {
            .left-frame {
                width: clamp(120px, 30vw, 200px);
            }
            
            .button,
            .sub-button,
            .sub2-button {
                padding: 6px;
                font-size: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <img src="logo.png" alt="Logo" class="logo" onclick="resetPage()">
        <div class="clock-container">
            <div id="clock" class="digital-clock">
                <div id="time" class="time-text">00:14:17</div>
                <div id="date" class="date-text">2025-01-23</div>
            </div>
            <button class="regulations-btn" onclick="openRegulations()">資安法規</button>
        </div>
        <div class="header-buttons">
            <button class="header-btn" onclick="window.open('https://moda.gov.tw/ACS/', '_blank')">資通安全署</button>
            <button class="header-btn" onclick="window.open('https://www.nics.nat.gov.tw/', '_blank')">資通安全研究院</button>
            <button class="header-btn" onclick="window.open('https://www.cnsonline.com.tw/?node=search&locale=zh_TW', '_blank')">CNS國家標準</button>
        </div>

        <div class="title-container">
            <div class="title">114年資通安全實地稽核檢查表</div>
            <div class="subtitle">稽核項目及稽核參考</div>
        </div>
        <div class="dropdown-container">
            <label for="main-options">稽核主項目:</label>
            <select id="main-options" onchange="updateSubOptions()">
                <option value="default">請選擇</option>
                <option value="1">(一)</option>
                <option value="2">(二)</option>
                <option value="3">(三)</option>
                <option value="4">(四)</option>
                <option value="5">(五)</option>
                <option value="6">(六)</option>
                <option value="7">(七)</option>
                <option value="8">(八)</option>
                <option value="9">(九)</option>
            </select>
            <label for="sub-options">次項目:</label>
            <select id="sub-options">
                <option value="default">請先選擇主項目</option>
            </select>
            <button onclick="confirmOption()">確定</button>
        </div>
        <div class="color-input">
            <input type="color" id="colorPicker" value="#00004d">
            <button class="color-button" onclick="changeButtonColor()">更改按鈕顏色</button>
        </div>
    </div>
    <div class="main">
        <div class="left-frame">
            <button class="button" onclick="showPDF('M01.pdf', 'middle')">(一) 核心業務及其重要性</button>
            <button class="button" onclick="showPDF('M02.pdf', 'middle')">(二) 資通安全政策及推動組織</button>
            <button class="button" onclick="showPDF('M03.pdf', 'middle')">(三) 專責人力及經費配置</button>
            <button class="button" onclick="showPDF('M04.pdf', 'middle')">(四) 資訊及資通系統盤點及風險評估</button>
            <button class="button" onclick="showPDF('M05.pdf', 'middle')">(五) 資通系統或服務委外辦理之管理措施</button>
            <button class="button" onclick="showPDF('M06.pdf', 'middle')">(六) 資通安全維護計畫與實施情形之持續精進及績效管理機制</button>
            <button class="button" onclick="showPDF('M07.pdf', 'middle')">(七) 資通安全防護及控制措施</button>
            <button class="button" onclick="showPDF('M08.pdf', 'middle')">(八) 資通系統發展;及維護安全</button>
            <button class="button" onclick="showPDF('M09.pdf', 'middle')">(九) 資通安全事件通報應變及情資評估因應</button>
            
            <div class="sub-buttons">
                <button class="sub2-button" onclick="showPDF('M10.pdf', 'middle')">常見問題</button>
                <button class="sub2-button" onclick="showPDF('應辦比較.pdf', 'middle')">應辦比照</button>
            </div>    
        <div class="sub-buttons">
            <button class="sub-button" onclick="showPDF('01資通安全管理法.pdf', 'middle')">資安管理</button>
            <button class="sub-button" onclick="showPDF('02資通安全管理法施行細則.pdf', 'middle')">施行細則</button>
        </div>
        <div class="sub-buttons">
            <button class="sub-button" onclick="showPDF('03資通安全責任等級分級辦法.pdf', 'middle')">等級分級</button>
            <button class="sub-button" onclick="showPDF('04資通安全事件通報及應變辦法.pdf', 'middle')">通報應變</button>
        </div>

        <div class="sub-buttons">
            <button class="sub-button" onclick="showPDF('05特定非公務機關資通安全維護計畫實施情形稽核辦法.pdf', 'middle')">稽核辦法</button>
            <button class="sub-button" onclick="showPDF('06資通安全情資分享辦法.pdf', 'middle')">情資分享</button>
        </div>

        <div class="sub-buttons">
            <button class="sub-button" onclick="showPDF('07公務機關所屬人員資通安全事項獎懲辦法.pdf', 'middle')">獎懲辦法</button>
            <button class="sub2-button" onclick="showPDF('附表一 資通安全責任等級A級之公務機關應辦事項修正規定.pdf', 'middle')">公務應辦</button>
        </div>
        <div class="sub-buttons">
            <button class="sub2-button" onclick="showPDF('附表二 資通安全責任等級A級之特定非公務機關應辦事項修正規定.pdf', 'middle')">特公應辦</button>
            <button class="sub2-button" onclick="showPDF('附表十 資通系統防護基準.pdf', 'middle')">防護基準</button>
        </div>


    </div>
        
        <div class="middle-frame" id="middle-frame">
            <img src="00.jpg" alt="初始圖片">
        </div>
        <div class="right-frame" id="right-frame">
            <img src="99.jpg" alt="右框初始圖片">
        </div>
    </div>
    <script>
        let isFirstClick = true;

        function showPDF(file, target) {
            const frame = document.getElementById(target + '-frame');
            frame.innerHTML = '<embed src="' + file + '" type="application/pdf" width="100%" height="100%">';

            if (isFirstClick) {
                const rightFrame = document.getElementById('right-frame');
                rightFrame.innerHTML = '<p style="font-size: 24px; font-weight: bold;">請選擇：稽核之主項目及次項目</p>';
                isFirstClick = false;
            }
        }

        function resetPage() {
            location.reload();
        }

        function changeButtonColor() {
            const colorPicker = document.getElementById('colorPicker');
            const buttons = document.querySelectorAll('.button');
            const backgroundColor = colorPicker.value;

            buttons.forEach(button => {
                button.style.backgroundColor = backgroundColor;
                button.style.color = getContrastColor(backgroundColor);
            });
        }

        function getContrastColor(bgColor) {
            const r = parseInt(bgColor.substr(1, 2), 16);
            const g = parseInt(bgColor.substr(3, 2), 16);
            const b = parseInt(bgColor.substr(5, 2), 16);
            const brightness = (r * 299 + g * 587 + b * 114) / 1000;
            return brightness > 128 ? 'black' : 'white';
        }

        function updateSubOptions() {
            const mainOptions = document.getElementById('main-options').value;
            const subOptions = document.getElementById('sub-options');

            subOptions.innerHTML = ''; // 清空子選單

            if (mainOptions === 'default') {
                subOptions.innerHTML = '<option value="default">請先選擇主項次</option>';
                return;
            }

            const subItems = {
                1: ['1.1', '1.2', '1.3', '1.4','1.5', '1.6', '1.7', '1.8'],
                2: ['2.1', '2.2', '2.3','2.4', '2.5', '2.6', '2.7'],
                3: ['3.1', '3.2','3.3','3.4','3.5' ],
                4: ['4.1', '4.2', '4.3', '4.4','4.5', '4.6', '4.7'],
                5: ['5.1', '5.2', '5.3','5.4', '5.5', '5.6','5.7', '5.8', '5.9', '5.10', '5.11', '5.12','5.13', '5.14', '5.15', '5.16'],
                6: ['6.1','6.2', '6.3','6.4', '6.5', '6.6',],
                7: ['7.1', '7.2', '7.3','7.4', '7.5', '7.6','7.7', '7.8', '7.9', '7.10', '7.11', '7.12','7.13', '7.14', '7.15', '7.16','7.17', '7.18', '7.19','7.20', '7.21', '7.22','7.23', '7.24', '7.25', '7.26'],
                8: ['8.1', '8.2', '8.3', '8.4', '8.5','8.6','8.7', '8.8', '8.9', '8.10', '8.11', '8.12','8.13'],
                9: ['9.1', '9.2', '9.3','9.4', '9.5', '9.6','9.7', '9.8', '9.9', '9.10', '9.11', '9.12','9.13', '9.14', '9.15', '9.16','9.17', '9.18'],
            };

            if (subItems[mainOptions]) {
                subItems[mainOptions].forEach(item => {
                    const option = document.createElement('option');
                    option.value = item;
                    option.textContent = item;
                    subOptions.appendChild(option);
                });
            }
        }
        
        
        function confirmOption() {
            const mainOption = document.getElementById('main-options').value;
            const subOption = document.getElementById('sub-options').value;

            if (mainOption === 'default' || subOption === 'default') {
                alert('請選擇完整的稽核項次');
            } else {
                const rightFrame = document.getElementById('right-frame');
                const pdfFile = `R${mainOption}-${subOption.split('.')[1]}.pdf`; // 動態生成PDF檔案名稱
                rightFrame.innerHTML = `<embed src="${pdfFile}" type="application/pdf" width="100%" height="100%">`;
            }
        }
        function openRegulations() {
            window.open('Regulations.html', '_blank');
        }
        
        function updateClock() {
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            
            document.getElementById('time').textContent = `${hours}:${minutes}:${seconds}`;
            document.getElementById('date').textContent = `${year}-${month}-${day}`;
        }

        // Update clock every second
        setInterval(updateClock, 1000);
        updateClock(); // Initial update
    </script>
</body>
</html>